{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2024-12-04T10:10:29.843522Z", "invocation_id": "ad7bd167-7ab2-45be-8c3f-4bd969bb254d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T10:10:29.684042Z", "completed_at": "2024-12-04T10:10:29.689974Z"}, {"name": "execute", "started_at": "2024-12-04T10:10:29.705885Z", "completed_at": "2024-12-04T10:10:29.747491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06509804725646973, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.citybikes_dbt.stg_coverage_analysis", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT *\n    FROM \"citybikes\".\"citybikes\".\"coverage_analysis\"\n)\n\nSELECT\n    analysis_id,\n    total_stations,\n    station_density,\n    service_area_sqmi,\n    coverage_gaps,\n    recommendations,\n    CURRENT_TIMESTAMP AS transformation_updated_at\nFROM source", "relation_name": "\"citybikes\".\"citybikes\".\"stg_coverage_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T10:10:29.687587Z", "completed_at": "2024-12-04T10:10:29.689783Z"}, {"name": "execute", "started_at": "2024-12-04T10:10:29.690158Z", "completed_at": "2024-12-04T10:10:29.748048Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06544208526611328, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.citybikes_dbt.stg_stations", "compiled": true, "compiled_code": "\n\nSELECT\n    station_id,\n    name as station_name,\n    latitude::float as latitude,\n    longitude::float as longitude,\n    free_bikes::bigint as free_bikes,\n    empty_slots::bigint as empty_slots,\n    (free_bikes::bigint + empty_slots::bigint) as total_capacity,\n    timestamp as _extracted_at,\n    _dlt_id as network_id,\n    address  -- Added this line\nFROM \"citybikes\".\"citybikes\".\"station_data\"", "relation_name": "\"citybikes\".\"citybikes\".\"stg_stations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-04T10:10:29.751359Z", "completed_at": "2024-12-04T10:10:29.753570Z"}, {"name": "execute", "started_at": "2024-12-04T10:10:29.753843Z", "completed_at": "2024-12-04T10:10:29.835946Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08529210090637207, "adapter_response": {"_message": "SELECT 1797", "code": "SELECT", "rows_affected": 1797}, "message": "SELECT 1797", "failures": null, "unique_id": "model.citybikes_dbt.station_metrics", "compiled": true, "compiled_code": "WITH stations AS (\n    SELECT *\n    FROM \"citybikes\".\"citybikes\".\"stg_stations\"\n),\n\ncalculations AS (\n    SELECT\n        station_id,\n        station_name,  -- Changed from name to station_name to match stg_stations\n        free_bikes,\n        empty_slots,\n        (free_bikes + empty_slots) AS total_capacity,\n        CASE\n            WHEN (free_bikes + empty_slots) > 0 \n            THEN ROUND((empty_slots::FLOAT / (free_bikes + empty_slots) * 100)::numeric, 2)\n            ELSE 0\n        END AS utilization_rate,\n        latitude,\n        longitude,\n        _extracted_at as timestamp,  -- Changed to match stg_stations\n        address,  -- This column might need to be removed if not in stg_stations\n        CURRENT_TIMESTAMP AS transformation_updated_at\n    FROM stations\n)\n\nSELECT\n    *,\n    CASE\n        WHEN utilization_rate BETWEEN 90 AND 100 THEN 'Nearly Empty'\n        WHEN utilization_rate BETWEEN 75 AND 89 THEN 'High Usage'\n        WHEN utilization_rate BETWEEN 40 AND 74 THEN 'Balanced'\n        WHEN utilization_rate BETWEEN 25 AND 39 THEN 'Underutilized'\n        WHEN utilization_rate BETWEEN 0 AND 24 THEN 'Oversupplied'\n\n    END AS utilization_category\nFROM calculations", "relation_name": "\"citybikes\".\"citybikes\".\"station_metrics\""}], "elapsed_time": 0.24007201194763184, "args": {"log_level_file": "debug", "log_level": "info", "require_resource_names_without_spaces": false, "profiles_dir": "/Users/reyestech/Downloads/project-tmc/.dbt", "log_path": "/Users/reyestech/Downloads/project-tmc/citybikes_dbt/logs", "partial_parse_file_diff": true, "cache_selected_only": false, "use_colors": true, "introspect": true, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "quiet": false, "project_dir": "/Users/reyestech/Downloads/project-tmc/citybikes_dbt", "write_json": true, "enable_legacy_logger": false, "exclude": [], "send_anonymous_usage_stats": true, "log_format_file": "debug", "log_file_max_bytes": 10485760, "strict_mode": false, "invocation_command": "dbt run", "log_format": "default", "version_check": true, "printer_width": 80, "select": [], "populate_cache": true, "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "show_resource_report": false, "which": "run", "use_colors_file": true, "static_parser": true, "macro_debugging": false, "empty": false, "vars": {}}}